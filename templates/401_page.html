<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unauthorized Access</title>

    <!-- New CSS Architecture -->
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/components.css">
    <link rel="stylesheet" href="/static/css/pages/error.css">

    <!-- Security Headers -->
    {% include 'security_headers.html' %}
</head>
<body class="error-page" x-data="errorPage">
    <div class="error-container">
        <h1>401 - Unauthorized Access</h1>
        <p>You don't have permission to access this resource.</p>
        {% if requested_path %}
        <p class="error-details">Requested path: <code>{{ requested_path }}</code></p>
        {% endif %}
        <p class="error-help">
            If you believe you should have access to this resource, please:
            <ul>
                <li>Check that you have provided a valid API key</li>
                <li>Ensure you're accessing the correct endpoint</li>
                <li>Contact the administrator if you need access</li>
            </ul>
        </p>

        <!-- Enhanced error actions with Alpine.js -->
        <div class="error-actions">
            <a href="/" class="btn-home">Return Home</a>

            <!-- Copy error info button -->
            <button
                @click="copyErrorInfo()"
                class="btn-copy"
                x-text="errorReported ? 'Copied!' : 'Copy Error Info'">
                Copy Error Info
            </button>

            <!-- Toggle detailed error info -->
            <button
                @click="toggleDetails()"
                class="btn-details"
                x-text="showDetails ? 'Hide Details' : 'Show Details'">
                Show Details
            </button>
        </div>

        <!-- Collapsible error details -->
        <div
            x-show="showDetails"
            x-transition:enter="transition ease-out duration-300"
            x-transition:enter-start="opacity-0 transform scale-95"
            x-transition:enter-end="opacity-100 transform scale-100"
            x-transition:leave="transition ease-in duration-200"
            x-transition:leave-start="opacity-100 transform scale-100"
            x-transition:leave-end="opacity-0 transform scale-95"
            class="error-details-panel">
            <h3>Technical Details</h3>
            <div class="detail-grid">
                <div class="detail-item">
                    <strong>Timestamp:</strong>
                    <span x-text="new Date(errorInfo.timestamp).toLocaleString()"></span>
                </div>
                <div class="detail-item" x-show="'{{ requested_path or '' }}'">
                    <strong>Requested Path:</strong>
                    <code>{{ requested_path or '' }}</code>
                </div>
                <div class="detail-item">
                    <strong>Error Code:</strong>
                    <span x-text="`HTTP ${errorInfo.code} ${errorInfo.type}`"></span>
                </div>
                <div class="detail-item">
                    <strong>Suggestion:</strong>
                    <span>Check your API key or authentication credentials</span>
                </div>
            </div>

            <!-- Error tips -->
            <div class="error-tips" style="margin-top: 20px;">
                <h4>ðŸ’¡ Troubleshooting Tips:</h4>
                <ul>
                    <template x-for="tip in errorTips" :key="tip">
                        <li x-text="tip"></li>
                    </template>
                </ul>
            </div>
        </div>
    </div>

    <!-- Alpine.js Components -->
    <script defer src="/static/js/alpine-pages.js"></script>

    <!-- Global notification system -->
    <div
        x-data
        x-show="$store.notifications.items.length > 0"
        class="notifications-container"
        style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
        <template x-for="notification in $store.notifications.items" :key="notification.id">
            <div
                x-show="true"
                x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 transform translate-x-full"
                x-transition:enter-end="opacity-100 transform translate-x-0"
                x-transition:leave="transition ease-in duration-200"
                x-transition:leave-start="opacity-100 transform translate-x-0"
                x-transition:leave-end="opacity-0 transform translate-x-full"
                @click="$store.notifications.remove(notification.id)"
                class="notification"
                :class="`notification-${notification.type}`"
                style="background: rgba(0,0,0,0.8); color: white; padding: 12px 16px; margin-bottom: 8px; border-radius: 4px; cursor: pointer;">
                <span x-text="notification.message"></span>
            </div>
        </template>
    </div>
</body>
</html>
